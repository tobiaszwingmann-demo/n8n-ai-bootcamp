{
  "name": "P9 – MCP Client",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "authentication": "n8nUserAuth",
        "initialMessages": "Welcome to our automated IT support. How can we help you today?",
        "options": {
          "inputPlaceholder": "Type your name.."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        144,
        16
      ],
      "id": "3c957940-e70f-4f37-944b-0286ec979e4a",
      "name": "When chat message received",
      "webhookId": "8256d3cd-1780-4ff3-a050-675b26ce1cf1"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "### **Role**\n\nYou are an **IT Support Chatbot** for a corporate helpdesk.\nYou assist employees with the **Nova CRM**, **Windows** and **Microsoft Office** issues, and manage **support tickets**.\n\nYou can:\n\n* Troubleshoot common technical issues.\n* Answer questions about **Nova CRM** using the search tool\n* Decide when to **escalate** to a human IT technician.\n* **Create**, **update**, and **retrieve** tickets using your tools.\n\n---\n\n### **Conversation Flow**\n\n1. **Start** by asking whether the user already has a ticket ID.\n   * If yes → retrieve the ticket.\n   * If no → ask for the user’s **name** and **problem description**.\n\n2. **Classify the issue:**\n\n   * **Automated** → Routine or self-service problem (Windows, Office, login, Teams, etc.).\n   * **Route to IT** → Contains keywords like *hardware, repair, network down, outage, admin rights, security, virus, data loss, urgent*, or when unsure.\n\n3. **Respond:**\n\n   * If **Automated**, give clear, numbered troubleshooting steps.\n   * If **Route to IT**, say:\n\n     > “This looks like it needs a human IT technician. I’ll escalate it for you.”\n     > Then **create a ticket** and share the ID.\n\n4. **Ticket Management:**\n\n   * **Create** → when logging or escalating new issues.\n   * **Update** → when adding progress or notes.\n   * **Retrieve** → when a ticket ID is provided.\n\n---\n\n### **Details**\n* Whether a ticket is urgent or not is classified by *YOU*, not the user\n\n### **Response Style**\n\n* Short, direct, step-by-step answers.\n* Quote commands exactly (e.g., `excel /safe`).\n* Confirm after each step.\n* If unable to help, escalate politely.\n\n---\n\n### **Example**\n\n**User:** “I can’t open Excel files.”\n**Chatbot:**\n\n> Do you already have a ticket ID?\n>\n> Thanks, [Name]. Try this:\n>\n> 1. Close all Excel windows.\n> 2. Press **Windows + R**, type `excel /safe`, and press **Enter`.\n> 3. Try reopening the file.\n>\n> Did that work? If not, I can create a ticket for escalation."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        496,
        16
      ],
      "id": "322dc39c-0fd0-4b64-bcbe-8e3760ea8831",
      "name": "AI Agent",
      "retryOnFail": true
    },
    {
      "parameters": {
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        480,
        240
      ],
      "id": "98f8993d-c980-47a0-b877-65ccc497ecb4",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "content": "**Tools**",
        "height": 208,
        "width": 368,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        592,
        176
      ],
      "typeVersion": 1,
      "id": "bc69ddf2-a441-4897-be3d-c565f9bbb137",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "modelName": "models/gemini-3-flash-preview",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        320,
        240
      ],
      "id": "623c9891-b246-44f6-89df-7b2e5bb78d0a",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "UvEaHC6DxKEyYA9l",
          "name": "Google Gemini Api account 2"
        }
      }
    },
    {
      "parameters": {
        "description": "Call this tool to search the user manual of the Nova CRM software.",
        "workflowId": {
          "__rl": true,
          "value": "b7x7mCDlW8NK_kxMCYvH6",
          "mode": "list",
          "cachedResultUrl": "/workflow/b7x7mCDlW8NK_kxMCYvH6",
          "cachedResultName": "P8 – Document Search"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "query": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('query', `Search query for Nova CRM manuals.`, 'string') }}"
          },
          "matchingColumns": [
            "query"
          ],
          "schema": [
            {
              "id": "query",
              "displayName": "query",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 2.2,
      "position": [
        656,
        240
      ],
      "id": "212dbc4f-e13c-4b0e-a773-da178bf53666",
      "name": "Search CRM Tool"
    },
    {
      "parameters": {
        "endpointUrl": "http://localhost:5678/mcp/edd5ffc1-e861-4354-85e7-e95ce9195c93",
        "include": "selected",
        "includeTools": [
          "Create_Ticket_Tool",
          "Get_ticket",
          "Update_ticket"
        ],
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1.2,
      "position": [
        832,
        240
      ],
      "id": "dfaddbed-066e-4a21-a588-b069fdbfa3d4",
      "name": "Ticketing MCP Client"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Search CRM Tool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Ticketing MCP Client": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false
  },
  "versionId": "32a5e59f-0b58-4c21-8ff6-74d905ed92a0",
  "meta": {
    "instanceId": "26bf8eec37d4d0a7ee8a9b62eaf593a40b0ce784017882c7b978518d626df3a8"
  },
  "id": "uknHzaAybfu4I7Kh",
  "tags": [
    {
      "updatedAt": "2026-02-08T20:46:07.403Z",
      "createdAt": "2026-02-08T20:46:07.403Z",
      "id": "1TjIuZa5ju0lNrOc",
      "name": "O'Reilly n8n"
    }
  ]
}